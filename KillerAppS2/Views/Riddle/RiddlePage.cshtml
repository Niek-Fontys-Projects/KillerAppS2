@model KillerAppS2.ViewModel.RiddlePageModel

@{
    Layout = "~/Views/Shared/_layout.cshtml";
}

<!DOCTYPE html>

<html>
<head>
    <style>
        ._categories a {
            margin: 10px 4px 10px 4px;
        }
    </style>
</head>
<body>
    <div class="col-sm-10 _categories" style="margin: auto auto auto 16px; border: 2px solid black; border-radius: 5px 5px; width: 120px;">
        @foreach (var category in Model.Categories.Categories)
        {
            <div class="row">
                <a asp-controller="Riddle" asp-action="Category" asp-route-_categoryName="@category.CategoryName">@category.CategoryName</a>
            </div>
        }
    </div>
    @foreach (var riddle in Model.Get.Riddles)
    {
        <div>
            <a onclick="SetRiddleName('@riddle.RiddleName')">@riddle.RiddleName</a>
            <a>@riddle.RiddleContent</a>
            <a>@riddle.Answer</a>
            @foreach (var category in riddle.Categories)
            {
                <a asp-controller="Riddle" asp-action="Category" asp-route-_categoryName="@category.CategoryName">@category.CategoryName</a>
            }
            @foreach (var message in riddle.Messages)
            {
                <a>@message.MessageContent</a>
                <a>@message.User.UserName</a>
                <a>@message.Time</a>
            }
        </div>

    }
    @using Microsoft.AspNetCore.Http;
    @if (!String.IsNullOrEmpty(Context.Session.GetString("UserID")))
    {
        <form method="post" asp-controller="Riddle" asp-action="PostMessage">
            <input asp-for="Post.UserID" value="@Context.Session.GetString("UserID")" type="hidden" />
            <input asp-for="Post.RiddleName" value="" id="riddleName" type="hidden" />
            <input asp-for="Post.Message" class="form-control" />
            <div><input type="submit" value="Send" class="btn" /></div>
        </form>
    }
</body>
</html>

<script>
    function SetRiddleName(_name)
    {
        document.getElementById("riddleName").value = _name;
    }
</script>